# Claude Gazette - Briefing for Claude

> **Purpose**: Knowledge transfer between Claude Code and Claude Web.
> **Audience**: Claude AI and developer

---

## What is this project

Claude Gazette is an Astro-based static site that displays AI-curated content digests from Reddit and Hacker News. Features a dark blue futuristic theme with Claude's personality integration through 12 expressions, plus an autonomous boids flocking animation background. Reads JSON digest files generated by the parent ClaudeRedditor project.

---

## How it works (data flow)

```
1. INGESTION: ../outputs/web/*.json â†’ Astro getStaticPaths()
2. RENDERING: JSON data â†’ Astro components â†’ Static HTML pages
3. DISPLAY: Dark theme + Swarm background + Claude expressions
4. NAVIGATION: Story cards â†’ Detail pages â†’ Bookmarks
```

Detailed explanation:
The site reads pre-generated JSON files from the parent project's `outputs/web/` directory during build time. Each digest JSON contains classified stories with metadata (category, confidence, tags, reasoning). Astro's `getStaticPaths()` generates static pages for each digest and story. The SwarmBackground component runs a boids flocking algorithm on a canvas layer, creating subtle ambient movement. Claude expressions (12 variants) are selected based on story category and confidence level, displaying the AI's "reaction" to each story.

---

## Tech stack

- **Language**: TypeScript/JavaScript
- **Main Frameworks/Libs**:
  - Astro 5.16.11: Static site generation with component islands
  - Tailwind CSS 4.1.18: Utility-first styling with custom theme
- **Database**: None (reads static JSON files)
- **External APIs**: None (fully static)
- **Infrastructure**: Cloudflare Pages (automated deployment via `../scripts/deploy-web.sh` called by n8n workflow)

---

## Main CLI commands

| Command | What it does | Usage example |
|---------|--------------|---------------|
| `npm run dev` | Start dev server at localhost:4321 | `npm run dev` |
| `npm run build` | Build static site to `dist/` | `npm run build` |
| `npm run preview` | Preview production build locally | `npm run preview` |
| `npm run astro check` | Run type checking | `npm run astro check` |

---

## Project structure

```
web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/      # Reusable Astro components
â”‚   â”‚   â”œâ”€â”€ SwarmBackground.astro   # Boids flocking animation
â”‚   â”‚   â”œâ”€â”€ StoryCard.astro         # Story preview with expression
â”‚   â”‚   â”œâ”€â”€ BookmarkCard.astro      # Bookmark display
â”‚   â”‚   â””â”€â”€ TagBadge.astro          # Category/topic tags
â”‚   â”œâ”€â”€ layouts/
â”‚   â”‚   â””â”€â”€ Layout.astro            # Site-wide layout + nav
â”‚   â”œâ”€â”€ pages/                       # Routes (file-based routing)
â”‚   â”‚   â”œâ”€â”€ index.astro             # Homepage with digest list
â”‚   â”‚   â”œâ”€â”€ digest/[id].astro       # Individual digest view
â”‚   â”‚   â”œâ”€â”€ story/[id].astro        # Story detail with "Claude's Take"
â”‚   â”‚   â””â”€â”€ bookmarks.astro         # Bookmarks page
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â””â”€â”€ global.css              # Dark theme + Tailwind config
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ digest.ts               # TypeScript interfaces
â”œâ”€â”€ public/
â”‚   â””â”€â”€ claude/                     # 12 Claude expression images (1-12.png)
â””â”€â”€ dist/                           # Build output (generated)
```

**Key modules**:
- **SwarmBackground.astro**: Implements Reynolds' boids algorithm with separation, alignment, cohesion rules for autonomous particle animation
- **StoryCard.astro**: Maps story categories to Claude expressions using confidence-based selection
- **global.css**: Defines dark theme color system with navy backgrounds and cyan accents

---

## Critical design decisions

### Decision 1: Static Site Generation (SSG) vs Server-Side Rendering

**Why**: Content is pre-generated and doesn't change between builds; no need for dynamic server

**Discarded alternatives**: Next.js SSR, SvelteKit SSR

**Accepted trade-off**: Must rebuild site to reflect new digests (no live updates)

---

### Decision 2: Canvas-based Swarm Animation

**Why**: Hardware-accelerated, smooth 60fps, no dependencies, full control over visual style

**Discarded alternatives**:
- CSS animations (limited to simple patterns)
- Three.js (overkill for 2D particles, 100KB+ overhead)
- Lottie animation (static, not autonomous)

**Impact**: ~5KB JavaScript, <5% CPU usage, respects `prefers-reduced-motion`

---

### Decision 3: Confidence-Based Expression Mapping

**Why**: High confidence classifications deserve stronger emotional reactions; uncertainty should show tentative expressions

**Discarded alternatives**:
- Random expressions per category (less meaningful)
- Single expression per category (less nuanced)
- Manual tagging per story (not scalable)

**Accepted trade-off**: Requires maintaining expression mapping configuration as categories evolve

---

### Decision 4: Windows-Style SVG Icons

**Why**: Full control over color (cyan theme integration), scalable, no emoji rendering inconsistencies across platforms

**Discarded alternatives**:
- Emoji (inconsistent rendering, no color control)
- Icon font libraries (extra dependency, harder to customize)

**Impact**: Inline SVG adds ~50 bytes per icon but provides perfect theme integration

---

## Data and models

### Main data model

**Main entity**: Story (from Digest JSON)

Key fields:
- `id`: string - Format `YYYY-MM-DD-NNN` for digest number + story index
- `title`: string - Reddit/HN post title
- `article_title`: string | null - Title of linked article (if fetched)
- `article_body`: string | null - Article content extracted from URL
- `category`: CategoryEnum - Classification (technical, mystical, etc.)
- `confidence`: number - 0.0-1.0 classification confidence
- `topic_tags`: string[] - Topic keywords (e.g., "LLM", "Python")
- `format_tag`: string | null - Content format (tutorial, discussion, etc.)
- `reasoning`: string - Claude's classification explanation
- `radio_commentary`: string | null - Brief summary
- `red_flags`: string[] - Warning patterns detected
- `source`: string - Reddit subreddit or "Hacker News"
- `url`: string - Original post URL
- `score`: number - Upvotes/points
- `num_comments`: number - Comment count

**Relationships**: Stories belong to Digests (one-to-many), Bookmarks reference Stories by ID

---

### Data transformation flow

```
JSON File (../outputs/web/claudeia_2026-01-27.json)
  â†’ Astro getStaticPaths() (loads all digest JSONs)
  â†’ Static HTML generation (one page per story)
  â†’ SwarmBackground injected into layout
  â†’ Expression mapping applied based on category+confidence
  â†’ Static site deployed
```

**Formats**:
- Input: JSON with `{ project, generated_at, stories: [...], story_count }`
- Output: Static HTML with embedded CSS/JS, optimized for CDN

---

## Configuration

### Critical environment variables

**None required** - fully static build with no secrets.

### Configuration files

**Astro config**: `astro.config.mjs`
- Site URL
- Build output directory
- Integrations (Tailwind)

**Tailwind config**: Embedded in `src/styles/global.css` using `@theme` directive
- Custom colors (navy, cyan)
- Category badge colors
- Dark theme utilities

**SwarmBackground config**: Inline in `SwarmBackground.astro`
```javascript
const CONFIG = {
  boidCount: 50,              // Number of particles
  maxSpeed: 1.8,              // Movement speed
  maxForce: 0.03,             // Steering strength
  separationRadius: 25,       // Personal space
  alignmentRadius: 50,        // Flock coordination
  cohesionRadius: 50,         // Flock attraction
  showConnections: true,      // Draw lines between nearby boids
};
```

---

## Current state

**Version**: 1.0.0

**Last update**: January 2026

### Features

âœ… **Implemented**:
- Dark blue futuristic theme with cyan accents
- Boids flocking animation background (autonomous, 60fps)
- 12 Claude expressions with confidence-based selection
- Windows-style SVG navigation buttons
- Story detail pages with "Claude's Take" section
- Bookmark management (read-only, managed by CLI)
- Responsive design for mobile/desktop
- Accessibility: `prefers-reduced-motion` support

ðŸ“‹ **Known TODOs**:
- Interactive bookmark editing (currently CLI-only)
- Search/filter functionality
- Dark/light theme toggle
- RSS feed generation

---

## Typical use cases

### Case 1: View Latest Digest

**Goal**: Read the most recent AI-curated stories

**Flow**:
1. Navigate to homepage (`/`)
2. Click on most recent digest card
3. Browse story cards with Claude expressions
4. Click story to read full analysis

**Example**:
```bash
# After building
open http://localhost:4321/
# Click "January 27, 2026" digest
# Click story card to see detail page
```

---

### Case 2: Bookmark Management

**Goal**: Track stories to read or implement later

**Flow**:
1. CLI: `./reddit-analyzer bookmark add 2026-01-27-003`
2. CLI: `./reddit-analyzer bookmark export` (generates bookmarks.json)
3. Rebuild site: `npm run build`
4. View bookmarks at `/bookmarks`

---

### Case 3: Deploy to Production

**Goal**: Publish updated digests to web

**Flow**:
1. Generate new digest: `./reddit-analyzer digest --project claudeia`
2. Build site: `cd web && npm run build`
3. Deploy `dist/` folder to hosting (Netlify/Vercel/etc.)

---

## Limitations and caveats

### Known limitations

- **No live updates**: Must rebuild site to show new digests (static generation)
- **Bookmark editing**: Must use CLI to add/edit bookmarks (no web UI)
- **Search**: No built-in search (could add with Pagefind or similar)

### Non-intuitive behaviors

- **Expression mapping**: Expressions are category-dependent, so same confidence may show different expressions
- **Swarm animation**: Runs on canvas, not CSS, so DevTools won't show animation keyframes
- **Build time**: With many digests, build time increases linearly (static generation of all pages)

---

## Development context

**Original motivation**: Transform the basic digest viewer into a personality-rich, visually distinctive site that reflects Claude's analytical character and futuristic aesthetic.

**Evolution**: Started as minimal Astro template â†’ added dark theme â†’ integrated Claude expressions â†’ added boids animation â†’ refined to Windows-style UI elements.

**Current usage**:
- Frequency: Built after each digest generation (daily or on-demand)
- Context: Personal content curation dashboard, potential public showcase

---

## Key code patterns

### Most common usage pattern

```javascript
// Expression selection based on category and confidence
const getClaudeExpression = (category: string, confidence: number): string => {
  const expressionMap: Record<string, number[]> = {
    'technical': [1, 12, 5],  // [high conf, medium conf, low conf]
    // ... more categories
  };
  const expressions = expressionMap[category.toLowerCase()] || [5];
  const index = confidence >= 0.9 ? 0 : confidence >= 0.7 ? 1 : 2;
  return `/claude/${expressions[index]}.png`;
};
```

---

### Extension pattern

```astro
---
// Adding a new page to the site
// 1. Create file in src/pages/
import Layout from '../layouts/Layout.astro';
import type { Digest } from '../types/digest';

// 2. Fetch data (if dynamic) or use static content
const data = await fetchData();
---

<Layout title="Page Title">
  <!-- Your content here -->
  <!-- SwarmBackground is already included via Layout -->
</Layout>
```

---

## Notes for Claude Web

**Context for architecture discussions**:
- Static site optimized for CDN deployment
- Animation uses mathematical boids algorithm (no physics engine needed)
- Expression mapping is pure function (no state management)

**Pending decisions**:
- Whether to add client-side search (Pagefind vs Fuse.js)
- Whether to implement theme toggle (light mode)

**Improvement areas**:
- Could optimize build time with incremental static regeneration
- Could add RSS feed generation for subscribers
- Could implement web-based bookmark editing (requires backend or localStorage)

---

## Notes for Claude Code

**Project conventions**:
- Components use Astro syntax (`.astro` files)
- Styling via Tailwind utilities, theme in global.css
- TypeScript for type safety, interfaces in `src/types/`
- Claude expressions numbered 1-12 in `public/claude/`

**Areas requiring attention**:
- SwarmBackground.astro is ~300 lines of vanilla JS (consider extracting Boid class if it grows)
- Expression mapping duplicated in StoryCard.astro and story/[id].astro (could extract to utility)

**When contributing**:
- Test swarm animation performance on mobile devices
- Ensure new color additions follow navy/cyan palette
- Verify `prefers-reduced-motion` is respected for animations
- Run `npm run astro check` before committing

---

*Last updated: January 2026*
*Generated from: current code*
